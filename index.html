<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Green Jobs Training Program</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="https://api.tiles.mapbox.com/mapbox-gl-js/v2.14.1/mapbox-gl.js"></script>
    <link
      href="https://api.tiles.mapbox.com/mapbox-gl-js/v2.14.1/mapbox-gl.css"
      rel="stylesheet"
    />
    <style>
      body {
        margin: 0;
        padding: 0;
      }
      #map {
        position: absolute;
        top: 0;
        bottom: 0;
        width: 100%;
      }
    </style>
  </head>

  <body>
    <style>
      body {
        margin: 0;
        padding: 0;
      }
      #map {
        position: absolute;
        top: 0;
        bottom: 0;
        width: 100%;
      }
    </style>

    <body>
      <style>
        .rounded-rect {
          background: white;
          opacity: 1;
          border-radius: 10px;
          box-shadow: 0 0 50px -25px black;
        }

        .flex-center {
          position: absolute;
          display: flex;
          justify-content: center;
          align-items: center;
        }

        .flex-center.left {
          left: 0px;
        }

        .flex-center.right {
          right: 0px;
        }

        .sidebar-content {
          position: absolute;
          width: 95%;
          height: 95%;
          font-family: Franklin Gothic Urw, sans-serif;
          font-size: 32px;
          color: gray;
          display: block;
          justify-content: center;
          align-items: center;
        }

        .sidebar-toggle {
          position: absolute;
          width: 1.3em;
          height: 1.3em;
          overflow: visible;
          display: flex;
          justify-content: center;
          align-items: center;
        }

        .sidebar-toggle.left {
          right: -1.5em;
        }

        .sidebar-toggle:hover {
          color: #0aa1cf;
          cursor: pointer;
        }

        .sidebar {
          transition: transform 1s;
          z-index: 1;
          width: 350px;
          height: 90%;
        }

        .center {
          display: block;
          margin-left: auto;
          margin-right: auto;
          width: 50%;
                }
        
        a:link {
          color: black;
          background-color: transparent;
          text-decoration: none;
                }
        a:visited {
          color: mediumseagreen;
          background-color: transparent;
          text-decoration: none;
                }
        a:hover {
          color: rgb(47, 101, 60);
          background-color: transparent;
          text-decoration: underline;
        }
        a:active {
          color: blue;
          background-color: transparent;
          text-decoration: underline;
                  }

        /*
The sidebar styling has them "expanded" by default, we use CSS transforms to push them offscreen
The toggleSidebar() function removes this class from the element in order to expand it.
*/
        .left.collapsed {
          transform: translateX(-295px);
        }
      </style>

      <body>
        <div id="map">
          <div id="left" class="sidebar flex-center left collapsed">
            <div class="sidebar-content rounded-rect flex-center">
              <h2>
                <p
                  style="
                    line-height: 30pt;
                    text-align: center;
                    color: rgb(47, 101, 60);
                    font-size: 30pt;
                  "
                >
                  Green Jobs Training Programs
                </p>
              </h2>
              <p
                style="
                  line-height: 16pt;
                  text-align: center;
                  color: black;
                  font-size: 16pt;
                "
              >
                Some description here about the project, perhaps pulled from the
                introduction of the report. Maybe something about the size of the markers being relative to the size of the organization (in patrons)
              </p>

              <p
                style="
                  line-height: 16pt;
                  text-align: center;
                  color: black;
                  font-size: 12pt;
                "
              >
                <i
                  >Select the green markers on the map to learn more about each
                  program.</i
                >
              </p>

              <a href=”https://nycfuture.org/“>
                <img
                src="https://github.com/rneches/Green-Jobs-Workforce-Development/blob/main/CUF_logo_blue_labels%20(1).jpg?raw=true"
                alt="alttext"
                class="center"></a>
            </div>
          </div>
        </div>
      </body>
      <script>
        // The value for 'accessToken' begins with 'pk...'
        mapboxgl.accessToken =
          "pk.eyJ1Ijoicm5lY2hlcyIsImEiOiJjbG9ldDZ0c2kwNHlzMnF1aHc2Y3ZoYnRpIn0.6KYtFVJxn1QMxHjYhEN76Q";
        const map = new mapboxgl.Map({
          container: "map",
          // Replace YOUR_STYLE_URL with your style URL.
          style: "mapbox://styles/rneches/clog4zn5g006501qkg6f6azzy/draft",
          center: [-73.911, 40.722],
          zoom: 10.8,
        });

        // Code from the next step will go here.

        function toggleSidebar(id) {
          var elem = document.getElementById(id);
          var classes = elem.className.split(" ");
          var collapsed = classes.indexOf("collapsed") !== -1;

          var padding = {};

          if (collapsed) {
            // Remove the 'collapsed' class from the class list of the element, this sets it back to the expanded state.
            classes.splice(classes.indexOf("collapsed"), 1);

            padding[id] = 300; // In px, matches the width of the sidebars set in .sidebar CSS class
            map.easeTo({
              padding: padding,
              duration: 1000, // In ms, CSS transition duration property for the sidebar matches this value
            });
          } else {
            padding[id] = 0;
            // Add the 'collapsed' class to the class list of the element
            classes.push("collapsed");

            map.easeTo({
              padding: padding,
              duration: 1000,
            });
          }

          // Update the class list on the element
          elem.className = classes.join(" ");
        }

        map.on("load", function () {
          toggleSidebar("left");
        });

        /* 
Add an event listener that runs
  when a user clicks on the map element.
*/
        map.on("click", (event) => {
          // If the user clicked on one of your markers, get its information.
          const features = map.queryRenderedFeatures(event.point, {
            layers: ["geocoded-green-jobs-training-704r4g"], // replace with your layer name
          });
          if (!features.length) {
            return;
          }
          const feature = features[0];

          // Code from the next step will go here.
          /* 
    Create a popup, specify its options 
    and properties, and add it to the map.
  */

          const popup = new mapboxgl.Popup({ offset: [0, -15] })
            .setLngLat(feature.geometry.coordinates)
            .setHTML('<h3><p style="color:MediumSeaGreen; font-size:20px; line-height:22px"><a href="' +
                feature.properties.URL +
                '">' +
                feature.properties.program_name +
                "</a></h3>"+
              "<p><b>Patrons: </b>" +
                feature.properties.patrons +
                "</p>" +
                feature.properties.Description +
                "</p>"
            )

            .addTo(map);
        });
      </script>
    </body>
  </body>
</html>
